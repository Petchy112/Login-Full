<DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <title>User Profile</title>
    </head>
    <style>
        #add {
            text-align: right;
            border-bottom: 1px;
        }

        .profile {
            text-align: center;
        }

        li:hover {
            color: blue;
            text-decoration: underline;
        }
    </style>

    <body>
        <div class="profile">
            <p id="fname"></p>
            <p id="lname"></p>
            <p id="email"></p>
            <p id="phoneNumber"></p>
            <button onclick="logout(),location.href='/api/start'" type="submit">Sign out</button>
        </div>

        <div class="event">
            <h2 id="topic">
            </h2>
            <div id="description"></div>
            <br>
            <button onclick="location.href='/api/addEvent'" id="add" type="submit">Add Event</button>
        </div>

    </body>
    <script>
        var config = {
            method: 'GET',
            url: "http://localhost:80/api/data",
            headers: {
                'Authorization': 'Bearer ' + localStorage.getItem("accessToken")
            }
        };
        axios(config)
            .then(result => {
                //Store
                localStorage.setItem("fname", result.data.firstName);
                localStorage.setItem("lname", result.data.lastName);
                localStorage.setItem("email", result.data.email);
                localStorage.setItem("phoneNumber", result.data.phoneNumber);

                //Retrieve
                document.getElementById("fname").innerHTML = localStorage.getItem("fname");
                document.getElementById("lname").innerHTML = localStorage.getItem("lname");
                document.getElementById("email").innerHTML = localStorage.getItem("email");
                document.getElementById("phoneNumber").innerHTML = localStorage.getItem("phoneNumber");
            })
            .catch(error => console.log('error', error));


        var getEvent = {
            method: 'GET',
            url: "http://localhost:80/api/event",
            headers: {
                'Authorization': 'Bearer ' + localStorage.getItem("accessToken")
            }
        };
        axios(getEvent)
            .then(result => {
                console.log(result.data, 'result');
                //Store
                result.data.forEach(topic => {
                    console.log(topic);
                    document.getElementById("topic").innerHTML += `<li><a href=/api/eventDetail?id=${topic._id}>  ${topic.topic} </a></li>`

                })
            })
            .catch(error => console.log('error', error));


        async function logout() {
            var config = {
                method: 'post',
                url: 'http://localhost:80/api/logout',
                headers: {
                    'Authorization': 'Bearer ' + localStorage.getItem("accessToken")
                }
            };
            await axios(config)
                .then((response) => {
                    console.log(response.data);
                })
                .catch((error) => {
                    console.log(error);
                });

            await localStorage.removeItem("accessToken")
        }
        // function thisEvent() {
        //     var data = document.getElementById("topic").value
        //     console.log(data);
        //     var config = {
        //         method: 'get',
        //         url: 'http://localhost:80/api/event',
        //         headers: {
        //             'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmaXJzdE5hbWUiOiIzMDcg4LiB4Li04LiV4LiS4Li04LiB4Liy4LiN4LiI4LiZ4LmMIiwibGFzdE5hbWUiOiLguJTguLTguKnguILguJnguLLguJkiLCJlbWFpbCI6InBldGNoLjE1OTE4QGdtYWlsLmNvbSIsImlhdCI6MTYyNTAzNTk1OCwiZXhwIjoxNjI1MDM5NTU4LCJpc3MiOiJKV1QifQ.Qnbo2-pVkPrn8_-uifHbISHs7c7icoOfPNkzm6t8sQU'
        //         }
        //     };

        //     axios(config)
        //         .then(function (response) {
        //             console.log(JSON.stringify(response.data));
        //         })
        //         .catch(function (error) {
        //             console.log(error);
        //         });


        // }
    </script>

    </html>